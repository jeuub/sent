(this.webpackJsonpclient1=this.webpackJsonpclient1||[]).push([[0],{181:function(e,t,n){},183:function(e,t,n){},185:function(e,t,n){},186:function(e,t,n){"use strict";n.r(t);var c,r,a,s,i,o,l=n(0),u=n(55),j=n.n(u),d=n(29),b=n.n(d),h=n(35),O=n(16),p=n(65),f=n(20),m=n.n(f),v=n(8),x=(n(180),n(46)),g=n(201),k=n(204),w=n(188),_=n(205),y=n(202),S=n(76),N=(n(181),n(5)),I=function(e){var t=e.id,n=e.go,c=e.fetchedUser;return Object(l.useEffect)((function(){localStorage.getItem("sent-token")&&n("greeting")}),[]),Object(N.jsxs)(v.l,{id:t,className:"home-panel",children:[c&&Object(N.jsxs)(v.i,{className:"home-panel__greeting",children:[Object(N.jsxs)(v.q,{level:"1",weight:"semibold",style:{marginBottom:16},children:[Object(N.jsxs)("strong",{children:[c.first_name," ",c.last_name]}),",",Object(N.jsx)("br",{}),"\u043f\u0440\u0438\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u043c \u0442\u0435\u0431\u044f \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438 ",Object(N.jsx)("span",{children:"SENT"}),"."]}),Object(N.jsx)(v.e,{before:c.photo_200?Object(N.jsx)(v.c,{src:c.photo_200}):null})]}),Object(N.jsxs)(v.i,{className:"home-panel__actions",children:[Object(N.jsx)(v.k,{href:"http://pd-2021-2.std-1368.ist.mospolytech.ru/",target:"_blank",className:"home-panel__link",children:"\u0423\u0437\u043d\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435."}),Object(N.jsx)(v.d,{stretched:!0,size:"l",mode:"secondary",onClick:function(){return n("login")},children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c sent."}),Object(N.jsx)(v.d,{stretched:!0,size:"l",mode:"secondary",onClick:function(){return localStorage.clear()},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435"})]})]})},U=(n(183),n(39)),$=n(203),C=Object($.a)(c||(c=Object(U.a)(["\n  mutation signUp($username: String!, $vkid: String!) {\n    signUp(username: $username, vkid: $vkid)\n  }\n"]))),E=Object($.a)(r||(r=Object(U.a)(["\n  mutation signIn($username: String!, $vkid: String!) {\n    signIn(username: $username, vkid: $vkid)\n  }\n"]))),A=Object($.a)(a||(a=Object(U.a)(["\n  mutation hasAccount($vkid: String!) {\n    hasAccount(vkid: $vkid)\n  }\n"]))),z=Object($.a)(s||(s=Object(U.a)(["\n  mutation newNote($content: String!) {\n    newNote(content: $content) {\n      content\n      id\n      author {\n        username\n      }\n    }\n  }\n"]))),P=n(191),q=function(e){var t=e.id,n=e.go,c=e.fetchedUser,r=Object(P.a)(A),a=Object(O.a)(r,1)[0],s=Object(P.a)(E),i=Object(O.a)(s,1)[0],o=Object(P.a)(C),u=Object(O.a)(o,1)[0],j=Object(l.useState)(!1),d=Object(O.a)(j,2),b=d[0],p=d[1],f=function(){var e=Object(h.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a({variables:{vkid:"".concat(c.id)}});case 3:return n=e.sent,e.abrupt("return",null===(t=n.data)||void 0===t?void 0:t.hasAccount);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(h.a)(m.a.mark((function e(){var t,n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i({variables:{username:"".concat(c.first_name," ").concat(c.last_name),vkid:"".concat(c.id)}});case 3:return r=e.sent,localStorage.setItem("sent-token",null===(t=r.data)||void 0===t?void 0:t.signIn),p(!0),e.abrupt("return",null===(n=r.data)||void 0===n?void 0:n.signIn);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(h.a)(m.a.mark((function e(){var t,n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u({variables:{username:"".concat(c.first_name," ").concat(c.last_name),vkid:"".concat(c.id)}});case 3:return r=e.sent,localStorage.setItem("sent-token",null===(t=r.data)||void 0===t?void 0:t.signIn),p(!0),e.abrupt("return",null===(n=r.data)||void 0===n?void 0:n.signUp);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(h.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:e.sent?x():g();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.useEffect)((function(){p(!!localStorage.getItem("sent-token")),k()}),[]),Object(l.useEffect)((function(){b&&n("greeting")}),[b]),Object(N.jsx)(v.l,{id:t,children:Object(N.jsx)("div",{className:"login__spinner-wrapper",children:Object(N.jsx)(v.n,{size:"large",style:{margin:"20px 0"}})})})},K=(Object($.a)(i||(i=Object(U.a)(["\n  query Query {\n    noteFeed {\n      notes {\n        id\n        content\n        author {\n          username\n          id\n        }\n        createdAt\n        favoriteCount\n      }\n      cursor\n      hasNextPage\n    }\n  }\n"]))),Object($.a)(o||(o=Object(U.a)(["\n  query myNote {\n    me {\n      notes {\n        content\n      }\n    }\n  }\n"])))),V=n(196),W=n(197),B=(n(185),function(e){var t,n=e.id,c=(e.fetchedUser,e.go),r=Object(l.useState)(""),a=Object(O.a)(r,2),s=a[0],i=a[1],o=Object(P.a)(z),u=Object(O.a)(o,1)[0],j=Object(V.a)(K),d=j.loading,b=j.data,p=function(){var e=Object(h.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u({variables:{content:s}});case 3:c("main"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return null!==b&&void 0!==b&&null!==(t=b.me)&&void 0!==t&&t.notes.length&&c("main"),Object(N.jsx)(v.l,{id:n,children:d?null:Object(N.jsxs)("div",{className:"main__container",children:[Object(N.jsxs)("div",{children:[Object(N.jsx)("h3",{className:"main__logo",children:"SENT."}),Object(N.jsxs)("h2",{children:["\u041e\u0434\u043d\u0430 \u0444\u0440\u0430\u0437\u0430 - \u043d\u0430 \u0432\u0441\u0435,",Object(N.jsx)("br",{})," \u043d\u0430\u0432\u0441\u0435\u0433\u0434\u0430."]})]}),Object(N.jsxs)("div",{className:"main__form form",children:[Object(N.jsxs)("div",{className:"form__content ",children:[Object(N.jsx)(v.h,{children:Object(N.jsx)(v.j,{type:"text",placeholder:"Your phrase",value:s,onChange:function(e){return i(e.target.value)}})}),Object(N.jsx)(v.d,{onClick:p,before:Object(N.jsx)(W.a,{}),size:"m"})]}),Object(N.jsxs)(v.d,{mode:"tertiary",size:"m",className:"form__later",stretched:!0,onClick:function(){return c("main")},children:[" ","\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0440\u0430\u0437\u0443 \u043f\u043e\u0437\u0436\u0435..."]})]})]})})}),G=n(198),J=n(199),Q=n(200),T=function(){var e=Object(l.useState)("one"),t=Object(O.a)(e,2),n=t[0],c=t[1];return Object(N.jsx)(v.l,{children:Object(N.jsx)(v.g,{filled:!0,vertical:"bottom",children:Object(N.jsxs)(v.f,{style:{height:"100%"},activeStory:n,tabbar:Object(N.jsxs)(v.o,{children:[Object(N.jsx)(v.p,{selected:"one"===n,onClick:function(){return c("one")},text:"\u041d\u043e\u0432\u043e\u0441\u0442\u0438",children:Object(N.jsx)(G.a,{})}),Object(N.jsx)(v.p,{selected:"two"===n,onClick:function(){return c("two")},text:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c",children:Object(N.jsx)(J.a,{})}),Object(N.jsx)(v.p,{selected:"three"===n,onClick:function(){return c("three")},text:"\u041c\u0435\u0441\u0441\u0435\u043d\u0434\u0436\u0435\u0440",children:Object(N.jsx)(Q.a,{})})]}),children:[Object(N.jsx)(v.r,{id:"one",activePanel:"one",children:Object(N.jsx)(v.l,{id:"one",children:Object(N.jsx)(v.i,{style:{height:"450px"},children:"asdasdasd"})})}),Object(N.jsx)(v.r,{id:"two",activePanel:"two",children:Object(N.jsx)(v.l,{id:"two",children:Object(N.jsx)(v.i,{style:{height:"450px"},children:"asdasd\u044b\u0432\u0430\u044b\u0432\u0430\u044b\u0432asd"})})}),Object(N.jsx)(v.r,{id:"three",activePanel:"three",children:Object(N.jsx)(v.l,{id:"three",children:Object(N.jsx)(v.i,{style:{height:"450px"},children:"123123"})})})]})})})},F=Object(S.a)((function(e){var t=e.graphqlErrors;e.networkErrors;t&&t.map((function(e){var t=e.message;e.location,e.path;console.log("GraphQL error: ".concat(t))}))})),L=new x.a((function(e,t){var n=localStorage.getItem("sent-token");return e.setContext((function(e){var t=e.headers,c=void 0===t?{}:t;return{headers:Object(p.a)(Object(p.a)({},c),{},{authorization:n||null})}})),t(e)})),Y=Object(g.a)([L,F,new k.a({uri:"https://sent-server.herokuapp.com/api"})]),D=new w.a({cache:new _.a,link:Y,fetchOptions:{mode:"no-cors"}}),H=function(){var e=Object(l.useState)("home"),t=Object(O.a)(e,2),n=t[0],c=t[1],r=Object(l.useState)(null),a=Object(O.a)(r,2),s=a[0],i=a[1],o=Object(l.useState)(Object(N.jsx)(v.m,{size:"large"})),u=Object(O.a)(o,2),j=u[0],d=u[1];Object(l.useEffect)((function(){function e(){return(e=Object(h.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.send("VKWebAppGetUserInfo");case 2:t=e.sent,i(t),d(null);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return b.a.subscribe((function(e){var t=e.detail,n=t.type,c=t.data;if("VKWebAppUpdateConfig"===n){var r=document.createAttribute("scheme");r.value=c.scheme?c.scheme:"client_light",document.body.attributes.setNamedItem(r)}})),function(){e.apply(this,arguments)}(),function(){routerUnsubscribe()}}),[]);var p=function(e){c(e)};return Object(N.jsx)(y.a,{client:D,children:Object(N.jsx)(v.a,{children:Object(N.jsx)(v.b,{children:Object(N.jsxs)(v.r,{activePanel:n,popout:j,children:[Object(N.jsx)(I,{id:"home",fetchedUser:s,go:p}),Object(N.jsx)(q,{id:"login",fetchedUser:s,go:p}),Object(N.jsx)(B,{id:"greeting",fetchedUser:s,go:p}),Object(N.jsx)(T,{id:"main",fetchedUser:s,go:p})]})})})})};b.a.send("VKWebAppInit"),j.a.render(Object(N.jsx)(H,{}),document.getElementById("root"))}},[[186,1,2]]]);
//# sourceMappingURL=main.7b3f76a2.chunk.js.map